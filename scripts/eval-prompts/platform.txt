Design a comprehensive testing strategy for a dbt project with 100+ models across bronze/silver/gold layers, including schema tests, data tests, custom singular tests, and unit tests. Explain how to enforce data contracts at layer boundaries and ensure test coverage metrics.
---
Implement a custom generic test in dbt that validates cross-model referential integrity between fact and dimension tables, handles incremental models, and provides detailed failure messages with row-level diagnostics.
---
Create a data contract enforcement framework for dbt models that validates column-level constraints (nullability, uniqueness, accepted values), enforces naming conventions, and fails builds when contracts are violated. Include strategies for versioning contracts as schemas evolve.
---
Design a unit testing approach for complex dbt macros and models with multiple CTEs, including mock input data setup, expected output assertions, and integration with CI/CD pipelines for automated test execution.
---
Build a test coverage monitoring system for a dbt project that tracks which models have schema tests, data tests, and unit tests, identifies untested critical paths, and generates coverage reports that can be enforced in pull request checks.
